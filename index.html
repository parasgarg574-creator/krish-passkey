<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ankita Surprise ‚Äî Unlock</title>
<style>
  :root{--accent:#ff4675;--muted:#cbdbe6}
  body{font-family:Inter,system-ui,Arial;margin:0;background:#080812;color:#eef2f8;display:flex;align-items:center;justify-content:center;height:100vh;padding:18px}
  .card{width:100%;max-width:540px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:14px;padding:22px;box-shadow:0 12px 40px rgba(0,0,0,0.6);text-align:center}
  h1{color:var(--accent);margin:0 0 8px;font-size:20px}
  p{color:var(--muted);margin:6px 0 12px;line-height:1.4}
  .lockedBox{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;margin-bottom:12px}
  .count{font-weight:700;color:#ffd6e6}
  input[type="password"]{padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);width:100%;max-width:320px;margin-top:10px;background:rgba(255,255,255,0.02);color:#fff;font-size:16px}
  .btn{margin-top:12px;padding:11px 18px;border-radius:10px;background:var(--accent);border:none;color:#fff;font-weight:700;cursor:pointer}
  .hint{font-size:13px;color:#9fb0c8;margin-top:8px}
  .videoWrap{margin-top:14px;display:none}
  iframe, video{width:100%;height:320px;border-radius:10px;border:0}
  .error{color:#ffb4c2;margin-top:10px}
</style>
</head>
<body>
  <div class="card">
    <h1>üéÅ A Surprise for Ankita</h1>
    <p>Scan / open this link. The surprise opens only after the unlock time ‚Äî and then only with the secret passkey. üïä</p>

    <div id="locked" class="lockedBox">
      <div>üîí <strong id="statusText">Checking time‚Ä¶</strong></div>
      <div class="count" id="countdown"></div>
    </div>

    <!-- Passkey area (hidden until unlock time) -->
    <div id="passArea" style="display:none">
      <p class="hint">Enter the secret passkey you will get by scratching:</p>
      <input id="passInput" type="password" placeholder="Enter passkey" />
      <div><button class="btn" id="unlockBtn">Unlock Surprise</button></div>
      <div id="error" class="error"></div>
    </div>
    <!-- Scratch card container (initially hidden) -->
    <div id="scratchContainer" style="margin-top: 12px; max-width: 320px; margin-left:auto; margin-right:auto; display:none; position: relative;">
      <canvas id="scratchCanvas" width="320" height="80" style="border-radius:10px; background:#999; display:block; cursor: pointer;"></canvas>
      <div id="passkeyReveal" style="position:absolute; top:0; left:0; width:320px; height:80px; 
           display:flex; align-items:center; justify-content:center; color:#fff; font-weight:bold; font-size:22px; user-select:none; pointer-events:none;">
        Scratch to reveal passkey
      </div>
    </div>

    <!-- Video container (revealed on correct passkey) -->
    <div id="videoWrap" class="videoWrap">
      <!-- Embedded Google Drive preview (replace FILE_ID in script) -->
      <iframe id="gdvid" src="" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>

    <p class="hint">Note: Unlock uses the phone's local time. Make sure device clock & timezone are correct.</p>

    <!-- Terms & Conditions (inside .card) -->
    <div style="margin-top:18px; font-size:13px; color:#9fb0c8; text-align:left; max-width:100%; padding:0 10px;">
      <h3 style="color:#ff9fb0; font-size:16px; text-align:center;">üìú Terms & Conditions</h3>
      <ul style="padding-left: 20px; line-height:1.6; list-style-type: disc;">
        <li>You Should Have Proper Internet connection.</li>
        <li>Make sure That You Have another Phone with You.</li>
        <li>Ensure your device clock and timezone are correct for proper unlock timing.</li>
        <li>Once unlocked, enjoy the experience with sound on for full effect üéß</li>
      </ul>
    </div>
  </div>

<script>
/* ===== CONFIG - change these ===== */
const UNLOCK_HOUR = 24;            // 24-hour format (22 = 10 PM). change if needed.
const CORRECT_PASSKEY = "0512";  // replace with your secret passkey
const DRIVE_FILE_ID = "1z2MrQyDoSNnHZefnhp7KZNFctBm1sMCc"; // put your Google Drive file id here
/* ================================= */

const countdownEl = document.getElementById('countdown');
const statusText = document.getElementById('statusText');
const locked = document.getElementById('locked');
const passArea = document.getElementById('passArea');
const unlockBtn = document.getElementById('unlockBtn');
const passInput = document.getElementById('passInput');
const errorEl = document.getElementById('error');
const videoWrap = document.getElementById('videoWrap');
const gdif = document.getElementById('gdvid');
const scratchContainer = document.getElementById('scratchContainer');
const passkeyReveal = document.getElementById('passkeyReveal');

let passkeyRevealed = false; // flag to keep passkey input visible after reveal

function formatTwo(n){ return n<10 ? '0'+n : n; }

function checkTime(){
  const now = new Date();
  let unlockTime = new Date(now);
  unlockTime.setHours(UNLOCK_HOUR,0,0,0);

  // If unlock time is today but earlier than current time, or passed midnight logic
  if (now.getHours() < UNLOCK_HOUR) {
    // Unlock hour is later today
  } else if (now.getHours() >= UNLOCK_HOUR) {
    // If current time is after unlock hour, we are unlocked today
  }

  if(now >= unlockTime){
    statusText.innerText = "‚è≥ Time reached ‚Äî Scratch to reveal passkey!";
    countdownEl.innerText = "";

    scratchContainer.style.display = 'block';
    locked.style.display = 'block';

    if (!passkeyRevealed) {
      passArea.style.display = 'none';
    }
  } else {
    const diff = unlockTime - now;
    const h = Math.floor(diff / 3600000);
    const m = Math.floor((diff % 3600000) / 60000);
    const s = Math.floor((diff % 60000) / 1000);
    countdownEl.innerText = `Opens in ${formatTwo(h)}h ${formatTwo(m)}m ${formatTwo(s)}s`;
    statusText.innerText = "üîí Surprise locked ‚Äî come back at " + formatTwo(UNLOCK_HOUR) + ":00";

    scratchContainer.style.display = 'none';
    passArea.style.display = 'none';
    videoWrap.style.display = 'none';
  }
}

// run every second
setInterval(checkTime, 1000);
checkTime();

// Unlock button event
unlockBtn.addEventListener('click', function(){
  const val = passInput.value.trim();
  errorEl.innerText = "";
  if(!val){ 
    errorEl.innerText = "Enter the passkey."; 
    return; 
  }
  if(val === CORRECT_PASSKEY){
    // show video iframe
    const embed = `https://drive.google.com/file/d/${DRIVE_FILE_ID}/preview?autoplay=1`;
    gdif.src = embed;
    videoWrap.style.display = 'block';
    // hide lock/pass and scratch container
    locked.style.display = 'none';
    passArea.style.display = 'none';
    scratchContainer.style.display = 'none';
    // scroll to video on small screens
    setTimeout(()=> { window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}); }, 450);
  } else {
    errorEl.innerText = "‚ùå Wrong passkey ‚Äî try again.";
  }
});

const canvas = document.getElementById('scratchCanvas');
const ctx = canvas.getContext('2d');
const passkeyText = CORRECT_PASSKEY; // Your passkey

let isDrawing = false;
let lastPoint = null;
const threshold = 0.6; // 60% scratch threshold

// Fill canvas with gray
ctx.fillStyle = '#999';
ctx.fillRect(0, 0, canvas.width, canvas.height);

// Add text on canvas too
ctx.fillStyle = '#bbb';
ctx.font = '20px Arial';
ctx.textAlign = 'center';
ctx.textBaseline = 'middle';
ctx.fillText('Scratch here', canvas.width / 2, canvas.height / 2);

function getMousePos(e) {
  const rect = canvas.getBoundingClientRect();
  if(e.touches) {
    return {
      x: e.touches[0].clientX - rect.left,
      y: e.touches[0].clientY - rect.top
    };
  }
  return {
    x: e.clientX - rect.left,
    y: e.clientY - rect.top
  };
}

function scratchLine(from, to) {
  ctx.globalCompositeOperation = 'destination-out';
  ctx.lineWidth = 25;
  ctx.lineCap = 'round';
  ctx.beginPath();
  ctx.moveTo(from.x, from.y);
  ctx.lineTo(to.x, to.y);
  ctx.stroke();
  ctx.closePath();
  ctx.globalCompositeOperation = 'source-over';
}

function checkScratchPercent() {
  const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
  let transparentPixels = 0;
  for(let i = 3; i < imageData.data.length; i += 4){
    if(imageData.data[i] === 0) transparentPixels++;
  }
  const totalPixels = canvas.width * canvas.height;
  const scratched = transparentPixels / totalPixels;
  return scratched > threshold;
}

canvas.addEventListener('mousedown', e => {
  isDrawing = true;
  lastPoint = getMousePos(e);
});

canvas.addEventListener('touchstart', e => {
  e.preventDefault();
  isDrawing = true;
  lastPoint = getMousePos(e);
});

canvas.addEventListener('mousemove', e => {
  if(!isDrawing) return;
  const currentPoint = getMousePos(e);
  scratchLine(lastPoint, currentPoint);
  lastPoint = currentPoint;
  if(checkScratchPercent()) revealPasskey();
});

canvas.addEventListener('touchmove', e => {
  e.preventDefault();
  if(!isDrawing) return;
  const currentPoint = getMousePos(e);
  scratchLine(lastPoint, currentPoint);
  lastPoint = currentPoint;
  if(checkScratchPercent()) revealPasskey();
});

canvas.addEventListener('mouseup', () => { isDrawing = false; });
canvas.addEventListener('touchend', () => { isDrawing = false; });

function revealPasskey(){
  passkeyReveal.innerText = `Passkey: ${passkeyText}`;
  canvas.style.pointerEvents = 'none';
  passArea.style.display = 'block';
  passkeyRevealed = true;
}
</script>
</body>
</html>

